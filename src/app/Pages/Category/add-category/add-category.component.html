<div class="nopadding ">
    <div class="nopadding ">
        <div class="contain">
            <div class=" heading">
                <span class="leftheading">Categories</span>
            </div>
      <form [formGroup]="form">      
        <div class="maindiv row ">
            <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                    <div class="project_To_duplicate_block">
                        <span class="client_name_head_text">Category Name <span class="star">*</span></span>
                        <div class="input_text">
                            <input 
                            maxlength="50"
                            type="text" 
                            class="text" 
                            formControlName="categoryName"
                            (keydown)="onkeyDownAllFields()">
                        </div>
                    </div>
                    <div class="alert alert-danger" *ngIf="categoryName.touched && categoryName.invalid">
                      <div  *ngIf="!!categoryName.errors.required">Please enter Category Name.</div>
                      <div  *ngIf="!!categoryName.errors.minlength">Category Name should be greater than 3.</div>
                  </div> 
                </div>
            </div>
            
            <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                  <div class="project_To_duplicate_block">
                    <span class="client_name_head_text">Category Image <span class="star">*</span></span>
                    <div class="input_text">
                        <span *ngIf="editBoolean && S3image"> <a class="button editImageClass" [href]="'http://s3.amazonaws.com/wom-documents/'+this.imageArrayEdit['category_src']">View Categories image</a> </span> 
                      <input type="file" accept="image/*" (change)="uploadfiledata($event)"
                    formControlName="uploadfile" class="upload" />
                    </div>
                </div>
                </div>
            </div>
            <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                  <div class="project_To_duplicate_block">
                    <span class="client_name_head_text">Description <span class="star">*</span></span>
                    <div class="input_text">
                      <textarea 
                      maxlength="250"
                      name="" 
                      id="txtarea"  
                      rows="2" 
                      formControlName="description"
                      (keydown)="onkeyDownAllFields()"></textarea>
                    </div>
                </div>
                </div>             
              
            </div>
            <div class="alert alert-danger" *ngIf="description.touched && description.invalid">
              <div  *ngIf="!!description.errors.required">Please enter Description.</div>
              <div  *ngIf="!!description.errors.minlength">Description should be greater than 5.</div>
          </div> 
              <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                      <div class="nopadding col-lg-12 col-md-12 col-sm-12">
                        <div class="project_To_duplicate_block2">
                          <form  formArrayName="Parameter" class="formclass"> 
                          <div class="">
                           <span class="client_name_head_text2">Sub-Category <span class="star">*</span></span> 
                            <span class="plus_img" (click)="addParameter()"><img src="assets/images/BlueIcons/icons8-plus-40.png" class="img_class cp" data-toggle="tooltip" title="Add Sub-Category"></span>                                                
                          </div>
                          <div [formGroupName]="i" *ngFor="let param of Parameter.controls; let i=index" class="text_underline">
                            <div class="sub_inliner fiveclass">
                              {{i + 1}}
                            </div>
                            <div class="sub_line sub_inliner">
                                <input type="text" class="sub_text"  formControlName="subcategory" (keydown)="onkeyDownAllFields()" placeholder="Add Sub-Category">
                            </div>
                            <div class="tenclass sub_inliner" data-toggle="tooltip" title="Delete Sub-Category">
                                <span class="del_right" *ngIf="isDelete"><img src="assets/images/BlueIcons/trash.png" class="img_class cp" (click)="removeParameter(i,param)"></span>
                            </div> 
                            <!-- required validation fields -->
                            <div class="alert alert-danger subalert" *ngIf="!!param.controls.subcategory.touched && !!param.controls.subcategory.invalid">
                                <div  *ngIf="!!param.controls.subcategory.errors.required">Please Enter Sub-Category</div>
                             </div>
                            <!-- required validation fields --> 
                          <div formArrayName="AddingValues" class="formclass">
                            <div [formGroupName]="j" *ngFor="let addvalue of param.get('AddingValues').controls; let j=index">
                              <div class="item_inliner fiveclass"></div>
                              <div class="item_inliner sixtyclass">
                                <input type="text" class="sub_text" formControlName="addvaluesname" placeholder="Add Item" (keydown)="onkeyDownAllFields()">
                              </div>
                              <div class="item_inliner tenclass">
                               <span class="del_right" *ngIf="isDelete"><img src="assets/images/BlueIcons/trash.png" class="img_class cp" (click)="deleteNewValues(param.controls.AddingValues, j,addvalue,param)" data-toggle="tooltip" title="Delete Item"></span>                                
                              </div>
                                <!-- required validation fields -->
                            <div class="alert alert-danger leftspace" *ngIf="addvalue.controls.addvaluesname.touched && addvalue.controls.addvaluesname.invalid">
                                <div  *ngIf="addvalue.controls.addvaluesname.errors.required">Please Enter Item</div>
                             </div>
                            <!-- required validation fields -->  
                            </div>
                            <div class="add_item_btn">
                              <button class="add_item_btn_class"(click)="addNewValues(param.controls.AddingValues)">Add Items</button>
                            </div>
                          </div>
                          </div>
                          </form>
                        </div>
                      </div>             
                  </div>

              <div *ngIf="formerror && form.invalid" class="alert alert-danger">
                  Please fill all the details
              </div>
              <div *ngIf="error_in_adding_category" class="alert alert-danger">
                  Internal error occured
              </div>
              <div *ngIf="same_category" class="alert alert-danger">
                <!-- Category Name already present -->
                {{this.message}}
            </div>
              <div *ngIf="subCatDuplicate" class="alert alert-danger">
                  Sub-Categories should be unique
              </div>
              <div *ngIf="subCatITemDuplicate" class="alert alert-danger">
                Items should be unique
            </div>
              <div *ngIf="nosubCategories" class="alert alert-danger">
                Please Enter Sub-Category
              </div>
        <!-- <pre>{{form.value | json}}</pre> -->
        <div [ngClass]="{'backendErrorClass':this._communicationservice.backendError}" *ngIf="this._communicationservice.backendError">
            {{this._communicationservice.backendMsg}}
        </div>
        
              <!-- <div class="nopadding col-lg-12 col-md-12">
                  <span class="client_name_head_text">&nbsp;</span>
                  <input type="submit" value="Submit" class="btn btn-success1" (click)="submit(form.value)" *ngIf="!edit" [disabled]="form.invalid">
                  <input type="submit" value="Update" class="btn btn-success1" (click)="update(form.value)" *ngIf="edit" [disabled]="form.invalid">
                  <input type="submit" value="Cancel" class="btn btn-success2" (click)="cancel()">               
              </div> -->
          </div>
        </form> 
        <div class="nopadding col-lg-12 col-md-12 extraspace">
                <span class="client_name_head_text">&nbsp;</span>
            <div class="clientright">
                <div class="clientInliner">
                    <input type="submit" value="Cancel" class="btn btn-success2" (click)="cancel()">                               
                </div>
                <div class="clientInliner">
                    <input type="submit" value="Submit" class="btn btn-success1" (click)="submit(form.value)" *ngIf="!edit" [disabled]="form.invalid">
                    <input type="submit" value="Update" class="btn btn-success1" (click)="update(form.value)" *ngIf="edit" [disabled]="form.invalid">
                </div>             
            </div>
        </div>
    <div class="col-lg-12 col-md-12" class="extrabottom">
       </div>
    </div>
  </div> 
           
  <!-- edit message pop-up -->
  <p-dialog header="" 
  [(visible)]="display_message_for_category_add" 
  [closable]="false" 
  [modal]="true" 
  [responsive]="true" 
  [minWidth]="200" 
  [minY]="70" 
  [maximizable]="false" 
  [baseZIndex]="10000" appendTo="body">
  <div class="pop_open_close_wraper" *ngIf="display_message_for_category_add_message">
      <div class="pop_open_close_header pop_open_close_bottom">
          {{this.message}}
      </div>
      <div class="ok_class">
          <button (click)="okMessageForCategoryAdd()" class="pop_button pop_button_orange">OK</button>
      </div>
  </div>
  <div *ngIf="displayAddNo">
    <div class="container1">
        <p class="headBold" *ngIf="subCategoryPop">Are you sure you want to delete this Sub-Category?</p>
        <p class="headBold" *ngIf="itemPop">Are you sure you want to delete this Item?</p>  
        <div *ngIf="subCategoryPop || itemPop" class="center_class">
          <button type="button" class="btn1 popupbtn orangeclass" (click)="deleteSubPop()">Yes</button>
          <button type="button" class="btn1 popupbtn silverclass" (click)="closeDialogClient()">No</button>
        </div>
      </div>
  </div>
  </p-dialog>
